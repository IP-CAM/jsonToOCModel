<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Model生成器</title>

		<style>
			* {
				margin: 0px;
				padding: 0;
				list-style: none;
			}
			
			body,
			#mainContent {
				position: absolute;
				left: 0px;
				right: 0px;
				top: 0px;
				bottom: 0px;
			}
			
			#mainContent {
				padding: 16px;
				border: 1px solid blue;
				flex-direction: column;
				flex: 1;
			}
			
			div {
				display: flex;
			}
			
			header {
				border: 1px solid red;
			}
		</style>

	</head>

	<body>
		<div id="mainContent">
			<header style="margin-bottom: 16px;border: 1px solid gray;">json转Objective-C Model代码生成器<br>改进自json加速器.<br>新增特性:数组增加泛型,单文件,多维的正确处理</header>
			<div style="flex-direction: row;flex: 1;">
				<div style="flex: 4;margin-right: 16px;flex-direction: column;">
					<textarea id="jsonTextarea" name="" rows="" cols="" style="flex: 1;" placeholder="填写json"></textarea>
					<div style="height: 40px;flex-direction: row;align-items: center;">
						<label style="font-size: 14px;">填写前缀</label>
						<input type="text" name="prefix" id="prefix" style="flex: 1;align-self: stretch;" placeholder="前缀=公司前缀+接口名" />
					</div>
					<div style="height: 40px;flex-direction: row;align-items: center;">
						<label style="font-size: 14px;">填写基类</label>
						<input type="text" name="baseclass" id="baseclass" style="flex: 1;align-self: stretch;" placeholder="通常填写'Model'" />
					</div>
					<div style="height: 40px;flex-direction: row;align-items: center;">
						<input type="button" name="" id="" value="生成" onclick="generate()" style="flex: 1;border: none;align-self: stretch;" />
					</div>
				</div>
				<div style="flex: 6;flex-direction: column;">
					<textarea id="interface" name="" rows="" cols="" style="flex: 1;margin-bottom: 16px;"></textarea>
					<textarea id="implementation" name="" rows="" cols="" style="flex: 2;"></textarea>
				</div>
			</div>
		</div>
	</body>
	<script src="jsonToOCModel.js"></script>
	<script type="text/javascript">
		function generate() {
			var jsonString = document.getElementById("jsonTextarea").value;
			var prefixString = document.getElementById('prefix').value;
			var baseclassString = document.getElementById('baseclass').value;

			try {
				var jsonObj = JSON.parse(jsonString);
				if(jsonObj) {

					let interface = objToOCHeader(jsonObj, prefixString, baseclassString);
					let implementation = objToOCImplementation(jsonObj, prefixString, baseclassString);

					document.getElementById("interface").innerHTML = interface;
					document.getElementById("implementation").innerHTML = implementation;
				} else {
					alert('解析失败');
				}
			} catch(error) {
				if(error instanceof SyntaxError) {
					alert("解析失败" + error.message);
				} else {
					throw error;
				}
			}

		}
	</script>

</html>